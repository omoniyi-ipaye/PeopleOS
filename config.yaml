# PeopleOS Configuration
version: "1.1.0"

app:
  name: "PeopleOS"
  debug: false
  log_level: "INFO"  # DEBUG, INFO, WARNING, ERROR

ollama:
  host: "http://localhost:11434"
  model: "gemma3:4b"  # Model-agnostic: can be changed
  timeout: 30
  max_retries: 3
  response_max_tokens: 1500

ml:
  random_seed: 42
  shap_sample_size: 100
  risk_threshold_high: 0.75
  risk_threshold_medium: 0.50
  test_split_ratio: 0.2
  cross_validation_folds: 5

analytics:
  high_risk_dept_threshold: 0.20  # Departments with turnover above this are flagged

nlp:
  enabled: true
  batch_size: 20  # Reviews per LLM call
  sentiment_temperature: 0.3  # Lower = more consistent
  skill_extraction_temperature: 0.2
  topic_temperature: 0.5
  max_review_length: 500  # Truncate longer reviews
  topics_count: 5  # Number of dominant topics to extract

compensation:
  outlier_std_threshold: 2.0  # Standard deviations for outlier detection
  equity_warning_threshold: 0.15  # Gini coefficient warning level
  salary_percentile_bins: [25, 50, 75]

succession:
  high_performer_rating: 4.0  # Minimum rating for high-potential
  min_tenure_years: 2.0  # Minimum tenure for succession candidates
  readiness_weights:
    tenure: 0.3
    rating: 0.4
    risk_of_loss: 0.3

team_dynamics:
  min_team_size: 3  # Minimum employees to analyze team
  health_warning_threshold: 0.6  # Below this triggers warning
  diversity_metrics:
    - "age"
    - "tenure"
    - "salary"

fairness:
  enabled: true
  protected_attributes:
    - "Gender"
    - "Age_Group"
    - "Dept"
  four_fifths_threshold: 0.8  # EEOC 80% rule
  disparity_warning_threshold: 0.15  # Flag disparities above 15%
  run_on_predictions: true  # Analyze ML predictions for bias

sessions:
  directory: "sessions/"
  max_saved: 10

# Data persistence configuration
persistence:
  enabled: true
  database_path: "data/peopleos.db"
  upload_mode: "auto_update"  # Always update existing employees automatically
  keep_history: true  # Store historical snapshots for trend analysis
  history_retention_days: 365  # Keep 1 year of history

data:
  max_rows: 50000
  min_rows: 50
  required_columns:
    - "EmployeeID"
    - "Dept"
    - "Tenure"
    - "Salary"
    - "LastRating"
    - "Age"
  optional_columns:
    - "Attrition"
    - "PerformanceText"
    - "Gender"
    - "JobTitle"
    - "YearsInCurrentRole"
    - "YearsSinceLastPromotion"
    - "Education"
    - "Location"
    - "ManagerID"
  allowed_formats:
    - "csv"
    - "json"
    - "sqlite"

performance:
  app_load_timeout_seconds: 5
  model_train_timeout_seconds: 30
  llm_response_timeout_seconds: 10

logging:
  file_path: "logs/peopleos.log"
  max_file_size_mb: 10
  backup_count: 5
  format: "%(asctime)s | %(levelname)s | %(module)s | %(message)s"

# =============================================================================
# NEW ANALYTICS ENGINES (People OS v2.0)
# =============================================================================

survival:
  enabled: true
  min_sample_size: 50
  time_horizon_months: [3, 6, 12, 24]  # Prediction horizons
  cox_covariates:  # Variables for Cox Proportional Hazards model
    - "Salary"
    - "YearsSinceLastPromotion"
    - "YearsInCurrentRole"
    - "LastRating"
    - "Age"
    - "CompaRatio"
  stagnation_thresholds:
    warning: 0.7   # YearsInRole/Tenure ratio triggering warning
    critical: 0.9  # Ratio triggering critical alert
  risk_categories:
    high: 0.75      # Probability threshold for high risk
    medium: 0.50    # Probability threshold for medium risk

quality_of_hire:
  enabled: true
  performance_window_months: 12  # Measure performance at 12 months post-hire
  retention_window_months: 12    # Measure retention at 12 months
  min_cohort_size: 10            # Minimum hires for cohort analysis
  sources:  # Expected hiring sources
    - "Referral"
    - "LinkedIn"
    - "Agency"
    - "JobBoard"
    - "Internal"
    - "Website"
    - "Campus"
  quality_score_weights:
    performance: 0.4    # Weight for performance rating
    retention: 0.3      # Weight for staying at company
    promotion: 0.2      # Weight for receiving promotion
    ramp_time: 0.1      # Weight for time to full productivity
  interview_dimensions:  # Pre-hire assessment dimensions to track
    - "Technical"
    - "Cultural"
    - "Curiosity"
    - "Communication"
    - "Leadership"

structural:
  enabled: true
  span_of_control:
    optimal_min: 4       # Minimum optimal direct reports
    optimal_max: 8       # Maximum optimal direct reports
    warning_threshold: 12
    critical_threshold: 15
  stagnation:
    tenure_threshold: 3.0  # Years of tenure before stagnation analysis applies
    role_threshold: 0.8    # YearsInRole/Tenure ratio for stagnation flag
  promotion_equity:
    protected_attributes:
      - "Gender"
      - "Age_Group"
    significance_level: 0.05  # p-value threshold for statistical significance
    min_group_size: 10        # Minimum employees in group for analysis

sentiment:
  enabled: true
  survey_types:
    - "30-day"
    - "60-day"
    - "90-day"
    - "eNPS"
    - "Pulse"
  enps:
    promoter_threshold: 9    # Score >= 9 = Promoter
    detractor_threshold: 6   # Score <= 6 = Detractor
  early_warning:
    declining_trajectory: true  # Flag declining 30->60->90 scores
    low_score_threshold: 3.0    # Flag scores below this
    missing_survey_days: 14     # Alert if survey not completed within days
  onboarding:
    expected_surveys: ["30-day", "60-day", "90-day"]
    min_score_healthy: 3.5      # Minimum healthy onboarding score

templates:
  directory: "templates/"
  files:
    hr_data: "sample_hr_data_enhanced.csv"
    onboarding: "onboarding_survey_template.csv"
    enps: "enps_survey_template.csv"
    hiring: "hiring_data_template.csv"

# =============================================================================
# EMPLOYEE EXPERIENCE ENGINE
# =============================================================================

experience:
  enabled: true
  # Weights for EXI calculation (must sum to 1.0 when all signals present)
  index_weights:
    enps: 0.25
    onboarding: 0.15
    pulse: 0.15
    manager_satisfaction: 0.15
    engagement: 0.10
    work_life: 0.10
    career_growth: 0.10
  # Engagement segment thresholds (EXI score boundaries)
  segments:
    thriving: 80      # EXI >= 80
    content: 60       # EXI >= 60
    neutral: 40       # EXI >= 40
    disengaged: 20    # EXI >= 20
    # Critical: EXI < 20
  thresholds:
    at_risk_exi: 40           # Employees below this are flagged
    declining_days: 30        # Days of declining trend to flag
    critical_exi: 20          # Critical threshold for immediate action
  lifecycle_stages:
    new_hire_months: 6        # 0-6 months = New Hire
    ramping_months: 12        # 6-12 months = Ramping
    established_months: 36    # 12-36 months = Established
    # 36+ months = Veteran

# =============================================================================
# SCENARIO PLANNING ENGINE (Monte Carlo Simulation)
# =============================================================================

scenario:
  enabled: true
  max_scenarios_saved: 50
  default_time_horizon_months: 12

  # Monte Carlo simulation settings
  monte_carlo_iterations: 1000
  random_seed: 42
  confidence_intervals: [0.05, 0.25, 0.50, 0.75, 0.95]  # Percentiles to report

  # Cost assumptions for ROI calculations
  cost_assumptions:
    replacement_cost_multiplier: 1.5  # Times annual salary
    hiring_cost_base: 5000            # Base cost per hire
    training_cost_months: 3           # Months of reduced productivity
    productivity_ramp_months: 6       # Time to full productivity

  # Engine dependency behavior
  fallback_to_statistical: true   # Use statistical models if ML engines unavailable
  require_ml_for_accuracy: false  # Don't block scenarios if ML not available

  # Confidence thresholds based on sample size
  confidence:
    min_sample_for_high: 100      # High confidence if N >= 100
    min_sample_for_medium: 30     # Medium confidence if N >= 30
    # Low confidence if N < 30

  # Pre-built scenario templates
  templates:
    - name: "5% Engineering Raise"
      type: "compensation"
      description: "Simulate 5% salary increase for Engineering department"
      params:
        adjustment_type: "percentage"
        target:
          scope: "department"
          department: "Engineering"
        adjustment_value: 5.0

    - name: "Retain High-Risk Top Performers"
      type: "intervention"
      description: "Retention bonus for high-risk employees with top ratings"
      params:
        intervention_type: "retention_bonus"
        target_employees: "high_risk_high_performer"
        bonus_percentage: 10.0

    - name: "10% Headcount Reduction"
      type: "headcount"
      description: "Model impact of 10% workforce reduction"
      params:
        change_type: "reduction"
        target:
          scope: "all"
        change_percentage: 10.0
        selection_criteria: "performance"
